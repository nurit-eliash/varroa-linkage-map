# count the mites in each stage and sex
ploidy_summary = data %>%
dplyr::filter(body.part == "Body") %>%
group_by(Sex , stage_mature) %>%
# mutate(count_sample = n_distinct(sample_name)) %>% #count each smaple once
mutate(count_sample = n(sample_name)) %>%
select(c(Sex,stage_mature,count_sample)) %>%
unique()
# count the mites in each stage and sex
ploidy_summary = data %>%
dplyr::filter(body.part == "Body") %>%
group_by(Sex , stage_mature) %>%
# mutate(count_sample = n_distinct(sample_name)) %>% #count each smaple once
mutate(count_sample = count(sample_name)) %>%
select(c(Sex,stage_mature,count_sample)) %>%
unique()
data %>%
dplyr::filter(body.part == "Body") %>%
group_by(Sex , stage_mature) %>%
# mutate(count_sample = n_distinct(sample_name)) %>% #count each smaple once
mutate(count_sample = count(sample_name)) %>%
select(c(Sex,stage_mature,count_sample)) %>%
unique()
data %>%
dplyr::filter(body.part == "Body") %>%
group_by(Sex, stage_mature)
# count the mites in each stage and sex
ploidy_summary = data %>%
dplyr::filter(body.part == "Body") %>%
group_by(Sex, stage_mature) %>%
# mutate(count_sample = n_distinct(sample_name)) %>% #count each smaple once
mutate(count_sample = count(record_number)) %>%
select(c(Sex,stage_mature,count_sample)) %>%
unique()
data %>%
dplyr::filter(body.part == "Body") %>%
group_by(Sex, stage_mature) %>%
# mutate(count_sample = n_distinct(sample_name)) %>% #count each smaple once
mutate(count_sample = count(record_number))
class(record_number)
class(data$record_number)
# count the mites in each stage and sex
ploidy_summary = data %>%
dplyr::filter(body.part == "Body") %>%
group_by(Sex, stage_mature) %>%
mutate(count_sample = n_distinct(record_number)) %>% #count each smaple once
select(c(Sex,stage_mature,count_sample)) %>%
unique()
ploidy_summary
# count the mites in each stage and sex
ploidy_summary = data %>%
dplyr::filter(body.part == "Body") %>%
group_by(Sex, stage_mature) %>%
mutate(count_sample = n_distinct(record_number)) %>% #count each smaple once
select(c(Sex,stage_mature,count_sample)) %>%
unique()
ploidy_summary
data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
ggplot(aes(x = Ploidy, color = Sex, fill = Sex)) +
geom_density(alpha = .2) +
geom_rug(aes(x = Ploidy, color = Sex), alpha = 0.9, size = 1.5, length = unit(0.05, "npc")) +
ylab("Density") +
theme_classic2() +
theme(legend.position = "bottom") +
ggtitle("Varroa mite ploidy flow-cytometry") +
geom_vline(xintercept = 2, color = "red") +
geom_vline(xintercept = 1, color = "blue") +
# Add legend labels with counts
labs(color = paste0("{color} (n=",
ifelse(color == "red", 10, 14), ")"))
data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
ggplot(aes(x = Ploidy, color = Sex, fill = Sex)) +
geom_density(alpha = .2) +
geom_rug(aes(x = Ploidy, color = Sex), alpha = 0.9, size = 1.5, length = unit(0.05, "npc")) +
ylab("Density") +
theme_classic2() +
theme(legend.position = "bottom") +
ggtitle("Varroa mite ploidy flow-cytometry") +
geom_vline(xintercept = 2, color = "red") +
geom_vline(xintercept = 1, color = "blue") +
# Define color before labs
color <- Sex +
labs(color = paste0("{color} (n=",
ifelse(color == "red", 10, 14), ")"))
data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
ggplot(aes(x = Ploidy, color = Sex, fill = Sex)) +
geom_density(alpha = .2) +
geom_rug(aes(x = Ploidy, color = Sex), alpha = 0.9, size = 1.5, length = unit(0.05, "npc")) +
ylab("Density") +
theme_classic2() +
theme(legend.position = "bottom") +
ggtitle("Varroa mite ploidy flow-cytometry") +
geom_vline(xintercept = 2, color = "red") +
geom_vline(xintercept = 1, color = "blue") +
# Define color before labs
color <- Sex +
labs(color = paste0("{color} (n=",
ifelse(color == "red", 10, 14), ")"))
data
data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
ggplot(aes(x = Ploidy, color = Sex, fill = Sex)) +
geom_density(alpha = .2) +
geom_rug(aes(x = Ploidy, color = Sex), alpha = 0.9, size = 1.5, length = unit(0.05, "npc")) +
ylab("Density") +
theme_classic2() +
theme(legend.position = "bottom") +
ggtitle("Varroa mite ploidy flow-cytometry") +
geom_vline(xintercept = 2, color = "red") +
geom_vline(xintercept = 1, color = "blue") +
# Define color before labs
color <- Sex +
labs(color = paste0("{color} (n=",
ifelse(color == "red", 10, 14), ")"))
data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
ggplot(aes(x = Ploidy, fill = Sex)) +  # Remove color aesthetic
geom_density(alpha = .2) +
geom_rug(aes(x = Ploidy, color = Sex), alpha = 0.9, size = 1.5, length = unit(0.05, "npc")) +
ylab("Density") +
theme_classic2() +
theme(legend.position = "bottom") +
ggtitle("Varroa mite ploidy flow-cytometry") +
geom_vline(xintercept = 2, color = "red") +
geom_vline(xintercept = 1, color = "blue") +
scale_color_identity() +  # Add scale_color_identity
labs(fill = paste0("{fill} (n=",
ifelse(fill == "red", 10, 14), ")"))
data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
ggplot(aes(x = Ploidy, fill = Sex)) +  # Remove color aesthetic
geom_density(alpha = .2) +
geom_rug(aes(x = Ploidy, color = Sex), alpha = 0.9, size = 1.5, length = unit(0.05, "npc")) +
ylab("Density") +
theme_classic2() +
theme(legend.position = "bottom") +
ggtitle("Varroa mite ploidy flow-cytometry") +
geom_vline(xintercept = 2, color = "red") +
geom_vline(xintercept = 1, color = "blue") +
scale_color_identity() +  # Add scale_color_identity
labs(fill = paste0("{fill} (n=",
ifelse(fill = "red", 10, 14), ")"))
# or , plot only mature mites
data %>% dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
ggplot(aes(x=Ploidy, color = Sex, fill = Sex)) +
geom_density(alpha=.2) +
geom_rug(aes(x=Ploidy,color = Sex), alpha=0.9, size=1.5,length = unit(0.05, "npc"))+
ylab("Density") +
theme_classic2() +
theme(legend.position = "bottom") +
ggtitle("Varroa mite ploidy flow-cytometry") +
geom_vline(xintercept = 2, color = "red") +
geom_vline(xintercept = 1, color = "blue")
data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
ggplot(aes(x = Ploidy, fill = Sex)) +  # Remove color aesthetic
geom_density(alpha = .2) +
geom_rug(aes(x = Ploidy, color = Sex), alpha = 0.9, size = 1.5, length = unit(0.05, "npc")) +
ylab("Density") +
theme_classic2() +
theme(legend.position = "bottom") +
ggtitle("Varroa mite ploidy flow-cytometry") +
geom_vline(xintercept = 2, color = "red") +
geom_vline(xintercept = 1, color = "blue") +
scale_color_identity() +  # Add scale_color_identity
labs(fill = paste0("{fill} (n=",
ifelse(fill == "red", 10, 14), ")"))
data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
ggplot(aes(x = Ploidy, fill = Sex)) +  # Remove color aesthetic
geom_density(alpha = .2) +
geom_rug(aes(x = Ploidy, color = Sex), alpha = 0.9, size = 1.5, length = unit(0.05, "npc")) +
ylab("Density") +
theme_classic2() +
theme(legend.position = "bottom") +
ggtitle("Varroa mite ploidy flow-cytometry") +
geom_vline(xintercept = 2, color = "red") +
geom_vline(xintercept = 1, color = "blue") +
scale_color_identity() +  # Add scale_color_identity
labs(fill = paste0("{fill} (n=",
ifelse(as.character(fill) == "red", 10, 14), ")"))
colors <- unique(data$Sex)
data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
ggplot(aes(x = Ploidy, fill = Sex)) +  # Remove color aesthetic
geom_density(alpha = .2) +
geom_rug(aes(x = Ploidy, color = Sex), alpha = 0.9, size = 1.5, length = unit(0.05, "npc")) +
ylab("Density") +
theme_classic2() +
theme(legend.position = "bottom") +
ggtitle("Varroa mite ploidy flow-cytometry") +
geom_vline(xintercept = 2, color = "red") +
geom_vline(xintercept = 1, color = "blue") +
scale_color_identity() +  # Add scale_color_identity
labs(fill = paste0(colors, " (n=",
ifelse(colors == "Male", 10, 14), ")"))
data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
ggplot(aes(x = Ploidy, color = Sex, fill = Sex)) +
geom_density(alpha = .2) +
geom_rug(aes(x = Ploidy, color = Sex), alpha = 0.9, size = 1.5, length = unit(0.05, "npc")) +
ylab("Density") +
theme_classic2() +
theme(legend.position = "bottom") +
ggtitle("Varroa mite ploidy flow-cytometry") +
geom_vline(xintercept = 2, color = "red") +
geom_vline(xintercept = 1, color = "blue") +
scale_color_identity() +  # Add scale_color_identity
labs(fill = paste0(colors, " (n=",
ifelse(colors == "Male", 10, 14), ")"))
data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
ggplot(aes(x=Ploidy, color = Sex, fill = Sex)) +
geom_density(alpha=.2) +
geom_rug(aes(x=Ploidy,color = Sex), alpha=0.9, size=1.5,length = unit(0.05, "npc"))+
ylab("Density") +
theme_classic2() +
theme(legend.position = "bottom") +
ggtitle("Varroa mite ploidy flow-cytometry") +
geom_vline(xintercept = 2, color = "red") +
geom_vline(xintercept = 1, color = "blue") +
scale_fill_manual(values = c("blue", "red"),
labels = c("Females (14)", "Males (10)")) +
scale_color_manual(values = c("blue", "red"),
labels = c("Females (14)", "Males (10)")) +
guides(fill = guide_legend(title = NULL),
color = guide_legend(title = NULL))
data %>% dplyr::filter(body.part == "Body") %>%
ggplot(aes(x=Ploidy, color = Sex, fill = Sex)) +
geom_density(alpha=.2) +
geom_rug(aes(x=Ploidy,color = Sex), alpha=0.9, size=1.5,length = unit(0.05, "npc"))+
ylab("Density") +
theme_classic2() +
theme(legend.position = "none") +
ggtitle("Varroa mite ploidy
Flow-cytometry") +
facet_grid(.~stage_mature, space = 'free',drop = F,
labeller = my_strip_labels) # add labels
# or , plot only mature mites (with a help from ChatGPT)
data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
ggplot(aes(x=Ploidy, color = Sex, fill = Sex)) +
geom_density(alpha=.2) +
geom_rug(aes(x=Ploidy,color = Sex), alpha=0.9, size=1.5,length = unit(0.05, "npc"))+
ylab("Density") +
theme_classic2() +
theme(legend.position = "bottom") +
ggtitle("Varroa mite ploidy flow-cytometry") +
geom_vline(xintercept = 2, color = "red") +
geom_vline(xintercept = 1, color = "blue") +
scale_fill_manual(values = c("blue", "red"),
labels = c("Females (14)", "Males (10)")) +
scale_color_manual(values = c("blue", "red"),
labels = c("Females (14)", "Males (10)")) +
guides(fill = guide_legend(title = NULL),
color = guide_legend(title = NULL))
# or , plot only mature mites (with a help from ChatGPT)
data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
ggplot(aes(x=Ploidy, color = Sex, fill = Sex)) +
geom_density(alpha=.2) +
geom_rug(aes(x=Ploidy,color = Sex), alpha=0.9, size=1.5,length = unit(0.05, "npc"))+
ylab("Density") +
theme_classic2() +
theme(legend.position = "bottom") +
ggtitle("Varroa mite ploidy flow-cytometry") +
geom_vline(xintercept = 2, color = "red") +
geom_vline(xintercept = 1, color = "blue") +
scale_fill_manual(values = c("red", "blue"),
labels = c("Females (14)", "Males (10)")) +
scale_color_manual(values = c("red", "blue"),
labels = c("Females (14)", "Males (10)")) +
guides(fill = guide_legend(title = NULL),
color = guide_legend(title = NULL))
# or , plot only mature mites (with a help from ChatGPT)
data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
ggplot(aes(x=Ploidy, color = Sex, fill = Sex)) +
geom_density(alpha=.2) +
geom_rug(aes(x=Ploidy,color = Sex), alpha=0.9, size=1.5,length = unit(0.05, "npc"))+
ylab("Density") +
theme_classic2() +
theme(legend.position = "bottom") +
ggtitle("Varroa mite ploidy flow-cytometry") +
geom_vline(xintercept = 2, color = "red") +
geom_vline(xintercept = 1, color = "blue") +
scale_fill_manual(values = c("blue", "red"),
labels = c("Males (10)", "Females (14)")) +
scale_color_manual(values = c("blue", "red"),
labels = c("Males (10)", "Females (14)")) +
guides(fill = guide_legend(title = NULL),
color = guide_legend(title = NULL))
# or , plot only mature mites (with a help from ChatGPT)
data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
ggplot(aes(x=Ploidy, color = Sex, fill = Sex)) +
geom_density(alpha=.2) +
geom_rug(aes(x=Ploidy,color = Sex), alpha=0.9, size=1.5,length = unit(0.05, "npc"))+
ylab("Density") +
theme_classic2() +
theme(legend.position = "bottom") +
ggtitle("Varroa mite ploidy flow-cytometry") +
geom_vline(xintercept = 2, color = "blue") +
geom_vline(xintercept = 1, color = "red") +
scale_fill_manual(values = c("blue", "red"),
labels = c("Males (10)", "Females (14)")) +
scale_color_manual(values = c("blue", "red"),
labels = c("Males (10)", "Females (14)")) +
guides(fill = guide_legend(title = NULL),
color = guide_legend(title = NULL))
# or , plot only mature mites (with a help from ChatGPT)
data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
ggplot(aes(x=Ploidy, color = Sex, fill = Sex)) +
geom_density(alpha=.2) +
geom_rug(aes(x=Ploidy,color = Sex), alpha=0.9, size=1.5,length = unit(0.05, "npc"))+
ylab("Density") +
theme_classic2() +
theme(legend.position = "bottom") +
ggtitle("Varroa mite ploidy flow-cytometry") +
geom_vline(xintercept = 2, color = "red") +
geom_vline(xintercept = 1, color = "blue") +
scale_fill_manual(values = c("red", "blue"),
labels = c("Males (10)", "Females (14)")) +
scale_color_manual(values = c("red", "blue"),
labels = c("Males (10)", "Females (14)")) +
guides(fill = guide_legend(title = NULL, reverse = TRUE),
color = guide_legend(title = NULL, reverse = TRUE))
# or , plot only mature mites (with a help from ChatGPT)
data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
ggplot(aes(x=Ploidy, color = Sex, fill = Sex)) +
geom_density(alpha=.2) +
geom_rug(aes(x=Ploidy,color = Sex), alpha=0.9, size=1.5,length = unit(0.05, "npc"))+
ylab("Density") +
theme_classic2() +
theme(legend.position = "bottom") +
ggtitle("Varroa mite ploidy flow-cytometry") +
geom_vline(xintercept = 2, color = "red") +
geom_vline(xintercept = 1, color = "blue") +
scale_fill_manual(values = c("red", "blue"),
labels = c("Females (14)", "Males (10)")) +
scale_color_manual(values = c("red", "blue"),
labels = c("Females (14)", "Males (10)")) +
guides(fill = guide_legend(title = NULL, reverse = TRUE),
color = guide_legend(title = NULL, reverse = TRUE))
# or , plot only mature mites (with a help from ChatGPT)
data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
ggplot(aes(x=Ploidy, color = Sex, fill = Sex)) +
geom_density(alpha=.2) +
geom_rug(aes(x=Ploidy,color = Sex), alpha=0.9, size=1.5,length = unit(0.05, "npc"))+
ylab("Density") +
theme_classic2() +
theme(legend.position = "bottom") +
ggtitle("Varroa mite ploidy flow-cytometry") +
geom_vline(xintercept = 2, color = "red", linetype = "dashed") + # Make this dashed
geom_vline(xintercept = 1, color = "blue", linetype = "dashed") + # Make this dashed
scale_fill_manual(values = c("red", "blue"),
labels = c("Females (14)", "Males (10)")) +
scale_color_manual(values = c("red", "blue"),
labels = c("Females (14)", "Males (10)")) +
guides(fill = guide_legend(title = NULL, reverse = TRUE),
color = guide_legend(title = NULL, reverse = TRUE))
data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature")
ploidy_avg = data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
group_by(Sex) %>%
mutate(avg = mean(Ploidy))
ploidy_avg
ploidy_avg = data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
group_by(Sex) %>%
mutate(avg = mean(Ploidy)) %>% #count each smaple once
select(c(Sex,avg)) %>%
unique()
ploidy_avg
# or , plot only mature mites (with a help from ChatGPT)
data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
ggplot(aes(x=Ploidy, color = Sex, fill = Sex)) +
geom_density(alpha=.2) +
geom_rug(aes(x=Ploidy,color = Sex), alpha=0.9, size=1.5,length = unit(0.05, "npc"))+
ylab("Density") +
theme_classic2() +
theme(legend.position = "bottom") +
ggtitle("Varroa mite ploidy flow-cytometry") +
geom_vline(xintercept = 2.25, color = "red", linetype = "dashed") + # Make this dashed
geom_vline(xintercept = 1.63, color = "blue", linetype = "dashed") + # Make this dashed
scale_fill_manual(values = c("red", "blue"),
labels = c("Females (14)", "Males (10)")) +
scale_color_manual(values = c("red", "blue"),
labels = c("Females (14)", "Males (10)")) +
guides(fill = guide_legend(title = NULL, reverse = TRUE),
color = guide_legend(title = NULL, reverse = TRUE))
data %>% sumarize()
ploidy_summary
ploidy_avg
data %>%
group_by(Sex) %>%
summarise(
mean_ploidy = mean(degrees),
median_ploidy = median(degrees),
range_ploidy = max(degrees) - min(degrees),
q1_ploidy = quantile(degrees, 0.25),
q3_ploidy = quantile(degrees, 0.75)
)
data %>%
group_by(Sex) %>%
summarise(
mean_ploidy = mean(Ploidy),
median_ploidy = median(Ploidy),
range_ploidy = max(Ploidy) - min(Ploidy),
q1_ploidy = quantile(Ploidy, 0.25),
q3_ploidy = quantile(Ploidy, 0.75)
)
ploidy_avg
ploidy_avg = data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
group_by(Sex) %>%
mutate(avg = mean(Ploidy)) %>% #count each smaple once
mutate(median = median(Ploidy)) %>%
mutate(min = min(Ploidy)) %>%
mutate(max = max(Ploidy)) %>%
select(c(Sex,avg,median,min,max)) %>%
unique()
ploidy_avg
data %>% filter(Sex =="Female")
data %>% filter(Sex =="Female") %>% dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>% view()
ploidy_avg
data %>% dplyr::filter(body.part == "Body") %>%
ggplot(aes(x=Ploidy, color = Sex, fill = Sex)) +
geom_histogram(position="dodge") +
geom_density(alpha=.2) +
ylab("Count") +
theme_classic2() +
theme(legend.position = "none") +
ggtitle("Varroa mite ploidy count
Flow-cytometry") +
facet_grid(.~stage_mature, space = 'free',drop = F,
labeller = my_strip_labels) # add labels
# or , plot only mature mites, in hist
data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
ggplot(aes(x=Ploidy, color = Sex, fill = Sex)) +
geom_histogram(position="dodge") +
geom_density(alpha=.2) +
ylab("Count") +
theme_classic2() +
theme(legend.position = "none") +
ggtitle("Varroa mite ploidy count
Flow-cytometry") +
facet_grid(.~stage_mature, space = 'free',drop = F,
labeller = my_strip_labels) # add labels
# or , plot only mature mites, in hist
data %>%
dplyr::filter(body.part == "Body") %>%
dplyr::filter(stage_mature == "Mature") %>%
ggplot(aes(x=Ploidy, color = Sex, fill = Sex)) +
geom_histogram(position="dodge") +
geom_density(alpha=.2) +
ylab("Count") +
theme_classic2() +
theme(legend.position = "bottom") +
ggtitle("Varroa mite ploidy flow-cytometry") +
geom_vline(xintercept = 2.25, color = "red", linetype = "dashed") + # Make this dashed
geom_vline(xintercept = 1.63, color = "blue", linetype = "dashed") + # Make this dashed
scale_fill_manual(values = c("red", "blue"),
labels = c("Females (14)", "Males (10)")) +
scale_color_manual(values = c("red", "blue"),
labels = c("Females (14)", "Males (10)")) +
guides(fill = guide_legend(title = NULL, reverse = TRUE),
color = guide_legend(title = NULL, reverse = TRUE))
library(tidyverse)
library(dplyr)
library(ggplot2)
library(ggpubr)
#library(reshape2)
#library(hrbrthemes)
library("gridExtra")
#library(cowplot)
library(plotly)
