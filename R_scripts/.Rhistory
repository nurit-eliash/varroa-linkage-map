# set the families (include only families with at least one adult F2)
family = grep("grndat|grnson",gt$ID, value=TRUE) %>%
str_extract("[^_]+")  %>%
unique()
# define a list to put all the data frames in
obs <- list()
for (fam in family) {
obs[[fam]] <- table %>%
dplyr::select(starts_with(fam)) %>%
dplyr::filter_at(vars(matches("_fnd")), all_vars(. == "0/0")) %>% # force F0 female to be homo, like her son
dplyr::filter_at(vars(matches("_son")), all_vars(. == "0/0")) %>%
dplyr::filter_at(vars(matches("_dat")), all_vars(. == "0/1")) %>%
dplyr::select(contains("grn")) %>%
tidyr::pivot_longer(everything())  %>%
dplyr::rename(sample = name, gt = value) %>%
dplyr::count(sample, gt, .drop = FALSE) %>%
dplyr::filter(gt %in% c("0/0", "1/1", "0/1")) %>%
mutate(n = as.numeric(n)) %>%
group_by(sample) %>%
mutate(total = as.numeric(sum(n))) %>%
mutate(sex = case_when(
grepl("son", sample) ~ "Male",
grepl("dat", sample) ~ "Female"))
}
# bind all families together, to a final data frame containing all observed counts
observed <- do.call("rbind", obs) %>% mutate(sample = as.character(sample))
samples <- data.frame(sample = rep(unique(observed$sample), each =3), gt = rep(c("0/0", "0/1", "1/1")))
# define the group of abnormal males
abnorm_males = tibble(sample = c("240_241c_grnson", "400_401a_grnson","412_413a_grnson", "426_427b_grnson", "458_459a_grnson", "46_47d_grnson"), sex = "Male", normality = "abnormal")
samples_obs <- left_join(samples, observed, by=c("sample","gt")) %>% mutate(sex = case_when(
grepl("son", sample) ~ "Male",
grepl("dat", sample) ~ "Female")) %>%
group_by(sample) %>%
replace(is.na(.), 0) %>%
mutate(total = as.numeric(sum(n))) %>%
dplyr::mutate(prop = n/total) %>%
left_join(abnorm_males, by = "sample") %>%
dplyr::select(-sex.y) %>%
replace(is.na(.), "normal") %>%
dplyr::rename(sex = sex.x) %>%
unite("type", sex,normality, remove = FALSE)
# make a table with the expected proportions for the different modes of reproduction:
Haploid = data.frame(mode = "Haploid", gt = c("0/0", "0/1", "1/1"),prop = c(0.5, 0, 0.5))
Automixis = data.frame(mode = "Automixis", gt = c("0/0", "0/1", "1/1"),prop = c(0, 1, 0))
Sexual = data.frame(mode = "Sexual",gt = c("0/0", "0/1", "1/1"),prop = c(0.5, 0.5, 0))
modes = rbind(Haploid,Automixis,Sexual)
#   right_join(together, by = c("gt", "sex"),multiple = "all") %>%
#select(c("sample", "gt","sex","total" ,"mode", "prop"))
samples_obs_forPlot = samples_obs %>%
mutate(class = "Observed") %>%
dplyr::filter(normality == "normal") %>%
select(c("sample","gt", "total", "sex","prop","class")) %>%
rename(type = sex)
modes_forPlot = modes %>%
mutate(class = "Expected") %>%
rename(type = mode)
pooled_obs_count =  samples_obs %>%
dplyr::filter(total>=10) %>%
filter(gt =="0/0") %>%
group_by(sex) %>%
mutate(count = sum(total)) %>%
select(c(sex,count)) %>%
unique()
df = rbind(samples_obs_forPlot, modes_forPlot)
df %>% ggplot(aes(fill=gt, y=prop, x=type)) +
geom_bar(position="fill", stat="identity", ) +
xlab("") +
ylab("Genotype proportion") +
labs(title = "Offspring genotype, crossing (0/0) male x (0/1) female",
subtitle = "Pooled sites: females = 5,243, males = 6,001") +
labs(fill = "Genotype") +
theme_classic() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.subtitle = element_text(hjust = 0)) +
scale_fill_manual(values=c("#ffbf00", "#66b032","#1982c4"))+
theme(legend.position = "none") +
facet_grid(.~class,scales = 'free',space = 'free',drop = F)
View(samples_obs)
View(df)
# order the modes
df$type <- factor(df$type, level=c("haploid", "automixis", "sexual"))
df %>% ggplot(aes(fill=gt, y=prop, x=type)) +
geom_bar(position="fill", stat="identity", ) +
xlab("") +
ylab("Genotype proportion") +
labs(title = "Offspring genotype, crossing (0/0) male x (0/1) female",
subtitle = "Pooled sites: females = 5,243, males = 6,001") +
labs(fill = "Genotype") +
theme_classic() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.subtitle = element_text(hjust = 0)) +
scale_fill_manual(values=c("#ffbf00", "#66b032","#1982c4"))+
theme(legend.position = "none") +
facet_grid(.~class,scales = 'free',space = 'free',drop = F)
df = rbind(samples_obs_forPlot, modes_forPlot)
# order the modes
df$type <- factor(df$type, level=c("Haploid", "Automixis", "Sexual"))
df %>% ggplot(aes(fill=gt, y=prop, x=type)) +
geom_bar(position="fill", stat="identity", ) +
xlab("") +
ylab("Genotype proportion") +
labs(title = "Offspring genotype, crossing (0/0) male x (0/1) female",
subtitle = "Pooled sites: females = 5,243, males = 6,001") +
labs(fill = "Genotype") +
theme_classic() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.subtitle = element_text(hjust = 0)) +
scale_fill_manual(values=c("#ffbf00", "#66b032","#1982c4"))+
theme(legend.position = "none") +
facet_grid(.~class,scales = 'free',space = 'free',drop = F)
# order the modes
df$type <- factor(df$type, level=c("Haploid", "Automixis", "Sexual","Female","Male"))
df %>% ggplot(aes(fill=gt, y=prop, x=type)) +
geom_bar(position="fill", stat="identity", ) +
xlab("") +
ylab("Genotype proportion") +
labs(title = "Offspring genotype, crossing (0/0) male x (0/1) female",
subtitle = "Pooled sites: females = 5,243, males = 6,001") +
labs(fill = "Genotype") +
theme_classic() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.subtitle = element_text(hjust = 0)) +
scale_fill_manual(values=c("#ffbf00", "#66b032","#1982c4"))+
theme(legend.position = "none") +
facet_grid(.~class,scales = 'free',space = 'free',drop = F)
df$type
df = rbind(samples_obs_forPlot, modes_forPlot)
df$type
# order the modes
df$type <- factor(df$type, level=c("Haploid", "Automixis", "Sexual","Female","Male"))
df %>% ggplot(aes(fill=gt, y=prop, x=type)) +
geom_bar(position="fill", stat="identity", ) +
xlab("") +
ylab("Genotype proportion") +
labs(title = "Offspring genotype, crossing (0/0) male x (0/1) female",
subtitle = "Pooled sites: females = 5,243, males = 6,001") +
labs(fill = "Genotype") +
theme_classic() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.subtitle = element_text(hjust = 0)) +
scale_fill_manual(values=c("#ffbf00", "#66b032","#1982c4"))+
theme(legend.position = "none") +
facet_grid(.~class,scales = 'free',space = 'free',drop = F)
abnorm_males
samples
abnorm_males
# define a list to put all the data frames in
obs <- list()
for (fam in family) {
obs[[fam]] <- table %>%
dplyr::select(starts_with(fam)) %>%
dplyr::filter_at(vars(matches("_fnd")), all_vars(. == "0/0")) %>% # force F0 female to be homo, like her son
dplyr::filter_at(vars(matches("_son")), all_vars(. == "0/0")) %>%
dplyr::filter_at(vars(matches("_dat")), all_vars(. == "0/1")) %>%
dplyr::select(contains("grn")) %>%
tidyr::pivot_longer(everything())  %>%
dplyr::rename(sample = name, gt = value) %>%
dplyr::count(sample, gt, .drop = FALSE) %>%
dplyr::filter(gt %in% c("0/0", "1/1", "0/1")) %>%
mutate(n = as.numeric(n)) %>%
group_by(sample) %>%
mutate(total = as.numeric(sum(n))) %>%
mutate(sex = case_when(
grepl("son", sample) ~ "Male",
grepl("dat", sample) ~ "Female"))
}
# bind all families together, to a final data frame containing all observed counts
observed <- do.call("rbind", obs) %>% mutate(sample = as.character(sample))
samples <- data.frame(sample = rep(unique(observed$sample), each =3), gt = rep(c("0/0", "0/1", "1/1")))
# define the group of abnormal males
abnorm_males = tibble(sample = c("240_241c_grnson", "400_401a_grnson","412_413a_grnson", "426_427b_grnson", "458_459a_grnson", "46_47d_grnson"), sex = "Male", normality = "abnormal")
samples_obs <- left_join(samples, observed, by=c("sample","gt")) %>% mutate(sex = case_when(
grepl("son", sample) ~ "Male",
grepl("dat", sample) ~ "Female")) %>%
group_by(sample) %>%
replace(is.na(.), 0) %>%
mutate(total = as.numeric(sum(n))) %>%
dplyr::mutate(prop = n/total) %>%
left_join(abnorm_males, by = "sample") %>%
dplyr::select(-sex.y) %>%
replace(is.na(.), "normal") %>%
dplyr::rename(sex = sex.x) %>%
unite("type", sex,normality, remove = FALSE)
# make a table with the expected proportions for the different modes of reproduction:
Haploid = data.frame(mode = "Haploid", gt = c("0/0", "0/1", "1/1"),prop = c(0.5, 0, 0.5))
Automixis = data.frame(mode = "Automixis", gt = c("0/0", "0/1", "1/1"),prop = c(0, 1, 0))
Sexual = data.frame(mode = "Sexual",gt = c("0/0", "0/1", "1/1"),prop = c(0.5, 0.5, 0))
modes = rbind(Haploid,Automixis,Sexual)
samples_obs_forPlot = samples_obs %>%
mutate(class = "Observed") %>%
dplyr::filter(normality == "normal") %>%
select(c("sample","gt", "total", "sex","prop","class")) %>%
rename(type = sex)
modes_forPlot = modes %>%
mutate(class = "Expected") %>%
rename(type = mode)
pooled_obs_count =  samples_obs %>%
dplyr::filter(total>=10) %>%
filter(gt =="0/0") %>%
group_by(sex) %>%
mutate(count = sum(total)) %>%
select(c(sex,count)) %>%
unique()
df = rbind(samples_obs_forPlot, modes_forPlot)
pooled_obs_count
samples_obs_forPlot = samples_obs %>%
dplyr::filter(total>=10) %>%
mutate(class = "Observed") %>%
dplyr::filter(normality == "normal") %>%
select(c("sample","gt", "total", "sex","prop","class")) %>%
rename(type = sex)
modes_forPlot = modes %>%
mutate(class = "Expected") %>%
rename(type = mode)
pooled_obs_count =  samples_obs %>%
dplyr::filter(total>=10) %>%
dplyr::filter(normality == "normal") %>%
filter(gt =="0/0") %>%
group_by(sex) %>%
mutate(count = sum(total)) %>%
select(c(sex,count)) %>%
unique()
pooled_obs_count
df = rbind(samples_obs_forPlot, modes_forPlot)
# order the modes
df$type <- factor(df$type, level=c("Haploid", "Automixis", "Sexual","Female","Male"))
df %>% ggplot(aes(fill=gt, y=prop, x=type)) +
geom_bar(position="fill", stat="identity", ) +
xlab("") +
ylab("Genotype proportion") +
labs(title = "Offspring genotype, crossing (0/0) male x (0/1) female",
subtitle = "Pooled sites: females = 5,243, males = 6,001") +
labs(fill = "Genotype") +
theme_classic() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.subtitle = element_text(hjust = 0)) +
scale_fill_manual(values=c("#ffbf00", "#66b032","#1982c4"))+
theme(legend.position = "none") +
facet_grid(.~class,scales = 'free',space = 'free',drop = F)
#
my_strip_labels <- as_labeller(c(
"Expexted" = "Hypothetic reproductivce modes",
"Observed" = "Sex"))
df %>% ggplot(aes(fill=gt, y=prop, x=type)) +
geom_bar(position="fill", stat="identity", ) +
xlab("") +
ylab("Genotype proportion") +
labs(title = "Offspring genotype, crossing (0/0) male x (0/1) female",
subtitle = "Pooled sites: females = 5,243, males = 6,001") +
labs(fill = "Genotype") +
theme_classic() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.subtitle = element_text(hjust = 0)) +
scale_fill_manual(values=c("#ffbf00", "#66b032","#1982c4"))+
theme(legend.position = "none") +
facet_wrap(.~class,scales = 'free',space = 'free',drop = F)
df %>% ggplot(aes(fill=gt, y=prop, x=type)) +
geom_bar(position="fill", stat="identity", ) +
xlab("") +
ylab("Genotype proportion") +
labs(title = "Offspring genotype, crossing (0/0) male x (0/1) female",
subtitle = "Pooled sites: females = 5,243, males = 6,001") +
labs(fill = "Genotype") +
theme_classic() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.subtitle = element_text(hjust = 0)) +
scale_fill_manual(values=c("#ffbf00", "#66b032","#1982c4"))+
theme(legend.position = "none",
strip.placement = "outside",
strip.background = element_blank()) +
facet_grid(.~class, scales = 'free',space = 'free',drop = F,
labeller = my_strip_labels,  # add labels
strip.position = "bottom")
df %>% ggplot(aes(fill=gt, y=prop, x=type)) +
geom_bar(position="fill", stat="identity", ) +
xlab("") +
ylab("Genotype proportion") +
labs(title = "Offspring genotype, crossing (0/0) male x (0/1) female",
subtitle = "Pooled sites: females = 5,243, males = 6,001") +
labs(fill = "Genotype") +
theme_classic() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.subtitle = element_text(hjust = 0)) +
scale_fill_manual(values=c("#ffbf00", "#66b032","#1982c4"))+
theme(legend.position = "none",
strip.placement = "outside",
strip.background = element_blank()) +
facet_grid(.~class, scales = 'free',space = 'free',drop = F,
labeller = my_strip_labels)  # add labels
df %>% ggplot(aes(fill=gt, y=prop, x=type)) +
geom_bar(position="fill", stat="identity", ) +
xlab("") +
ylab("Genotype proportion") +
labs(title = "Offspring genotype, crossing (0/0) male x (0/1) female",
subtitle = "Pooled sites: females = 5,243, males = 6,001") +
labs(fill = "Genotype") +
theme_classic() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.subtitle = element_text(hjust = 0)) +
scale_fill_manual(values=c("#ffbf00", "#66b032","#1982c4"))+
theme(legend.position = "none") +
facet_grid(.~class, scales = 'free',space = 'free',drop = F)
#
my_strip_labels <- as_labeller(c(
"Expected" = "Expected proportions",
"Observed" = "Observed proportions"))
df %>% ggplot(aes(fill=gt, y=prop, x=type)) +
geom_bar(position="fill", stat="identity", ) +
xlab("") +
ylab("Genotype proportion") +
labs(title = "Offspring genotype, crossing (0/0) male x (0/1) female",
subtitle = "Pooled sites: females = 5,243, males = 6,001") +
labs(fill = "Genotype") +
theme_classic() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.subtitle = element_text(hjust = 0)) +
scale_fill_manual(values=c("#ffbf00", "#66b032","#1982c4"))+
theme(legend.position = "none") +
facet_grid(.~class, scales = 'free',space = 'free',drop = F,
labeller = my_strip_labels)  # add labels
pooled_obs_count
df %>% ggplot(aes(fill=gt, y=prop, x=type)) +
geom_bar(position="fill", stat="identity", ) +
xlab("") +
ylab("Genotype proportion") +
labs(title = "Offspring genotype, crossing (0/0) male x (0/1) female",
subtitle = "Pooled sites: females = 5,243, males = 5,747") +
labs(fill = "Genotype") +
theme_classic() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.subtitle = element_text(hjust = 0)) +
scale_fill_manual(values=c("#ffbf00", "#66b032","#1982c4"))+
theme(legend.position = "none") +
facet_grid(.~class, scales = 'free',space = 'free',drop = F,
labeller = my_strip_labels)  # add labels
df %>% ggplot(aes(fill=gt, y=prop, x=type)) +
geom_bar(position="fill", stat="identity", ) +
xlab("") +
ylab("Genotype proportion") +
labs(title = "Offspring genotype, crossing (0/0) male x (0/1) female",
subtitle = "Pooled sites: females = 5,243, males = 5,747") +
labs(fill = "Genotype") +
theme_classic() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.subtitle = element_text(hjust = 0)) +
scale_fill_manual(values=c("#ffbf00", "#66b032","#1982c4"))+
theme(legend.position = "bottom") +
facet_grid(.~class, scales = 'free',space = 'free',drop = F,
labeller = my_strip_labels)  # add labels
df %>% ggplot(aes(fill=gt, y=prop, x=type)) +
geom_bar(position="fill", stat="identity", ) +
xlab("blank") +
ylab("Genotype proportion") +
labs(title = "Offspring genotype, crossing (0/0) male x (0/1) female",
subtitle = "Pooled sites: females = 5,243, males = 5,747") +
labs(fill = "Genotype") +
theme_classic() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.subtitle = element_text(hjust = 0)) +
scale_fill_manual(values=c("#ffbf00", "#66b032","#1982c4"))+
theme(legend.position = "bottom") +
facet_grid(.~class, scales = 'free',space = 'free',drop = F,
labeller = my_strip_labels)  # add labels
df %>% ggplot(aes(fill=gt, y=prop, x=type)) +
geom_bar(position="fill", stat="identity", ) +
xlab(blank) +
ylab("Genotype proportion") +
labs(title = "Offspring genotype, crossing (0/0) male x (0/1) female",
subtitle = "Pooled sites: females = 5,243, males = 5,747") +
labs(fill = "Genotype") +
theme_classic() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.subtitle = element_text(hjust = 0)) +
scale_fill_manual(values=c("#ffbf00", "#66b032","#1982c4"))+
theme(legend.position = "bottom") +
facet_grid(.~class, scales = 'free',space = 'free',drop = F,
labeller = my_strip_labels)  # add labels
df %>% ggplot(aes(fill=gt, y=prop, x=type)) +
geom_bar(position="fill", stat="identity", ) +
xlab(blank) +
ylab("Genotype proportion") +
labs(title = "Offspring genotype, crossing (0/0) male x (0/1) female",
subtitle = "Pooled sites: females = 5,243, males = 5,747") +
labs(fill = "Genotype") +
theme_classic() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.subtitle = element_text(hjust = 0)) +
scale_fill_manual(values=c("#ffbf00", "#66b032","#1982c4"))+
theme(legend.position = "right") +
facet_grid(.~class, scales = 'free',space = 'free',drop = F,
labeller = my_strip_labels)  # add labels
df %>% ggplot(aes(fill=gt, y=prop, x=type)) +
geom_bar(position="fill", stat="identity", ) +
xlab() +
ylab("Genotype proportion") +
labs(title = "Offspring genotype, crossing (0/0) male x (0/1) female",
subtitle = "Pooled sites: females = 5,243, males = 5,747") +
labs(fill = "Genotype") +
theme_classic() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.subtitle = element_text(hjust = 0)) +
scale_fill_manual(values=c("#ffbf00", "#66b032","#1982c4"))+
theme(legend.position = "right") +
facet_grid(.~class, scales = 'free',space = 'free',drop = F,
labeller = my_strip_labels)  # add labels
df %>% ggplot(aes(fill=gt, y=prop, x=type)) +
geom_bar(position="fill", stat="identity", ) +
xlab("") +
ylab("Genotype proportion") +
labs(title = "Offspring genotype, crossing (0/0) male x (0/1) female",
subtitle = "Pooled sites: females = 5,243, males = 5,747") +
labs(fill = "Genotype") +
theme_classic() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.subtitle = element_text(hjust = 0)) +
scale_fill_manual(values=c("#ffbf00", "#66b032","#1982c4"))+
theme(legend.position = "right") +
facet_grid(.~class, scales = 'free',space = 'free',drop = F,
labeller = my_strip_labels)  # add labels
df %>% ggplot(aes(fill=gt, y=prop, x=type)) +
geom_bar(position="fill", stat="identity", ) +
axis.title.x = element_blank()+
ylab("Genotype proportion") +
labs(title = "Offspring genotype, crossing (0/0) male x (0/1) female",
subtitle = "Pooled sites: females = 5,243, males = 5,747") +
labs(fill = "Genotype") +
theme_classic() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.subtitle = element_text(hjust = 0)) +
scale_fill_manual(values=c("#ffbf00", "#66b032","#1982c4"))+
theme(legend.position = "bottome") +
facet_grid(.~class, scales = 'free',space = 'free',drop = F,
labeller = my_strip_labels)  # add labels
df %>% ggplot(aes(fill=gt, y=prop, x=type)) +
geom_bar(position="fill", stat="identity", ) +
ylab("Genotype proportion") +
labs(title = "Offspring genotype, crossing (0/0) male x (0/1) female",
subtitle = "Pooled sites: females = 5,243, males = 5,747") +
labs(fill = "Genotype") +
theme_classic() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.subtitle = element_text(hjust = 0)) +
scale_fill_manual(values=c("#ffbf00", "#66b032","#1982c4"))+
theme(legend.position = "bottome") +
facet_grid(.~class, scales = 'free',space = 'free',drop = F,
labeller = my_strip_labels)  # add labels
df %>% ggplot(aes(fill=gt, y=prop, x=type)) +
geom_bar(position="fill", stat="identity", ) +
ylab("Genotype proportion") +
labs(title = "Offspring genotype, crossing (0/0) male x (0/1) female",
subtitle = "Pooled sites: females = 5,243, males = 5,747") +
labs(fill = "Genotype") +
theme_classic() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.subtitle = element_text(hjust = 0)) +
scale_fill_manual(values=c("#ffbf00", "#66b032","#1982c4"))+
theme(legend.position = "bottom") +
facet_grid(.~class, scales = 'free',space = 'free',drop = F,
labeller = my_strip_labels)  # add labels
# order the x axis text
df$type <- factor(df$type, level=c("Haploid" ,"Sexual","Automixis","Female","Male"))
# change the labales
my_strip_labels <- as_labeller(c(
"Expected" = "Expected proportions",
"Observed" = "Observed proportions"))
df %>% ggplot(aes(fill=gt, y=prop, x=type)) +
geom_bar(position="fill", stat="identity", ) +
ylab("Genotype proportion") +
labs(title = "Offspring genotype, crossing (0/0) male x (0/1) female",
subtitle = "Pooled sites: females = 5,243, males = 5,747") +
labs(fill = "Genotype") +
theme_classic() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.subtitle = element_text(hjust = 0)) +
scale_fill_manual(values=c("#ffbf00", "#66b032","#1982c4"))+
theme(legend.position = "bottom") +
facet_grid(.~class, scales = 'free',space = 'free',drop = F,
labeller = my_strip_labels)  # add labels
pooled_obs_count =  samples_obs %>%
dplyr::filter(total>=10) %>%
dplyr::filter(normality == "normal") %>%
filter(gt =="0/0") %>%
group_by(sex) %>%
mutate(count = sum(total)) %>%
select(c(sex,count)) %>%
unique()
pooled_obs_count
