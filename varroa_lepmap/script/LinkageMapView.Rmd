---
title: "LinkageMapView-varroa genetic maps"
author: "Nurit Eliash"
date: '2022-07-15'
output:
  html_document:
    code_folding: hide
    theme: cerulean
    toc: yes
    toc_depth: 5
    toc_float:
      collapsed: yes
      df_print: paged
---
<style type="text/css">
  body{
  font-size: 12pt;
}
</style>

## Load libraries
```{r libraries, include=FALSE, warning=FALSE}
library("tidyverse")
library("plyr")
library("dplyr")
library("ggplot2")
library("scales")
library("ggpubr")
library("gridExtra") # for arranging a few plots in one area
#library("grid")
#library("GGally")
library("data.table")
library("stringr")
library("janitor")
library("plotly") # to identify outliers. 
#library("sp") # to identify outliers
library("readr") # to extract numbers from a vector
library("tidyr")
library("LinkageMapView") # for constructing the linkage map
library("RIdeogram") # for visualizing the variant physical sites on the chromosomes

knitr::opts_chunk$set(echo = TRUE)
```

The genetic maps are based on two different crosses: 
 - 0/0 x 0/1
 - 1/1 x 0/1
 
the position of the markers are based on recombination frequency (done by Lep-MAP OrderMarkrs2 module)
code in  ~/Documents/GitHub/varroa-linkage-map/varroa_lepmap/script/lep-MAP3-varroa.Rmd

## Genetic map based on 00 x 01 cross

### Markers positions, assuming recombinations in *both sexes*
```{r}
#load data of the markers position 
sites_recom = read.csv(file = "/Users/nuriteliash/Documents/GitHub/varroa-linkage-map/varroa_lepmap/results/00_01_cross/sites_recom.csv", header = TRUE, sep = " ")
# ~/Documents/GitHub/varroa-linkage-map/varroa_lepmap/script/lep-MAP3-varroa.Rmd

# change the names of the columns, so it will fit for the lmv command:
#>     group position    locus
#> 1 2170LG3    0.000 BSSR-094
#> 2 2170LG3    7.039   ESSR86
#> 3 2170LG3   11.123      F3H
#> 4 2170LG3   11.123     FLS1

#"group" is the LG (1-7) + add the sex
# "position" is the genetic position (cM on the LG)
# "locus" is the physical position (Chr_pos)

sites_recom_map <- sites_recom %>% dplyr::select(c(group=LG, position = cM, locus = POS, sex = sex))
head(sites_recom_map)

## Female positions, assuming recombination in both sexes ###
cM_Recom_femPOS <- sites_recom_map %>% filter(sex=="female_position") %>% select(-sex)
head(cM_Recom_femPOS)

#outfile = file.path("/Users/nuriteliash/Desktop", "cM_Recom_femPOS.pdf")
#lmv.linkage.plot(mapthis = cM_Recom_femPOS, outfile = outfile, main="Female positions, assuming recombination in both sexes",col.main = "red")

# density map: denmap=TRUE
outfile = file.path("/Users/nuriteliash/Desktop", "cM_Recom_femPOS_dens_00_01.pdf")
lmv.linkage.plot(mapthis = cM_Recom_femPOS, outfile = outfile, main="Female positions, based on 0/0 x 0/1 cross, assuming recombination in both sexes",col.main = "red", denmap=TRUE)

## Male positions, assuming recombination in both sexes
cM_Recom_malePOS <- sites_recom_map %>% filter(sex=="male_position") %>% select(-sex)
head(cM_Recom_malePOS)
  
#outfile = file.path("/Users/nuriteliash/Desktop", "cM_Recom_malePOS.pdf")
#lmv.linkage.plot(mapthis = cM_Recom_malePOS, outfile = outfile, main="Male positions, assuming recombination in both sexes",col.main = "blue")

# density map: denmap=TRUE
outfile = file.path("/Users/nuriteliash/Desktop", "cM_Recom_malePOS_dens_00_01.pdf")
lmv.linkage.plot(mapthis = cM_Recom_malePOS, outfile = outfile, main="Male positions, based on 0/0 x 0/1 cross, assuming recombination in both sexes",col.main = "blue", denmap=TRUE)
```

NOT included in the final MS
### Markers positions, assuming recombinations in *FEMALES ONLY*
```{r eval=FALSE, include=FALSE}
#load data from "~/Documents/GitHub/varroa-linkage-map/varroa_lepmap/script/lep-MAP3-varroa.Rmd"
# eard_delim(sites_0male)
head(sites_0male)

## Female positions, assuming recombination in both sexes
cM_0male_femPOS <- sites_0male %>% dplyr::select(c("Chr","female_position","POS"))
  names(cM_0male_femPOS) <- c("LG","position","locus")
  head(cM_0male_femPOS)
  
outfile = file.path("/Users/nuriteliash/Desktop", "cM_0male_femPOS.pdf")
lmv.linkage.plot(mapthis = cM_0male_femPOS, outfile = outfile, main="Female positions, assuming recombination in FEMALES only",col.main = "red")

## Male positions, assuming recombination in both sexes
cM_0male_malePOS <- sites_0male %>% dplyr::select(c("Chr","male_position","POS"))
  names(cM_0male_malePOS) <- c("LG","position","locus")
  head(cM_0male_malePOS)
  
outfile = file.path("/Users/nuriteliash/Desktop", "cM_0male_malePOS.pdf")
lmv.linkage.plot(mapthis = cM_0male_malePOS, outfile = outfile, main="Male positions, assuming recombination in FEMALES only",col.main = "blue")
```

### Markers positions, assuming recombinations in *MALES ONLY*
```{r eval=FALSE, include=FALSE}
#load data from "~/Documents/GitHub/varroa-linkage-map/varroa_lepmap/script/lep-MAP3-varroa.Rmd"
# eard_delim(sites_0fem)
head(sites_0fem)

## Female positions, assuming recombination in both sexes
cM_0fem_femPOS <- sites_0fem %>% dplyr::select(c("Chr","female_position","POS"))
  names(cM_0fem_femPOS) <- c("LG","position","locus")
  head(cM_0fem_femPOS)
  
outfile = file.path("/Users/nuriteliash/Desktop", "cM_0fem_femPOS.pdf")
lmv.linkage.plot(mapthis = cM_0fem_femPOS, outfile = outfile, main="Female positions, assuming recombination in MALES only",col.main = "red")

## Male positions, assuming recombination in both sexes
cM_0fem_malePOS <- sites_0fem %>% dplyr::select(c("Chr","male_position","POS"))
  names(cM_0fem_malePOS) <- c("LG","position","locus")
  head(cM_0fem_malePOS)
  
outfile = file.path("/Users/nuriteliash/Desktop", "cM_0fem_malePOS.pdf")
lmv.linkage.plot(mapthis = cM_0fem_malePOS, outfile = outfile, main="Male positions, assuming recombination in MALES only",col.main = "blue")
```

## Genetic map based on 11 x 01 cross

### Markers positions, assuming recombinations in *both sexes*
```{r}
#load data of the markers position 
sites_recom = read.csv(file = "/Users/nuriteliash/Documents/GitHub/varroa-linkage-map/varroa_lepmap/results/11_01_cross/sites_recom.csv", header = TRUE, sep = " ")
# ~/Documents/GitHub/varroa-linkage-map/varroa_lepmap/script/lep-MAP3-varroa.Rmd

# change the names of the columns, so it will fit for the lmv command:
#>     group position    locus
#> 1 2170LG3    0.000 BSSR-094
#> 2 2170LG3    7.039   ESSR86
#> 3 2170LG3   11.123      F3H
#> 4 2170LG3   11.123     FLS1

#"group" is the LG (1-7) + add the sex
# "position" is the genetic position (cM on the LG)
# "locus" is the physical position (Chr_pos)

sites_recom_map <- sites_recom %>% dplyr::select(c(group=LG, position = cM, locus = POS, sex = sex))
head(sites_recom_map)

## Female positions, assuming recombination in both sexes ###
cM_Recom_femPOS <- sites_recom_map %>% filter(sex=="female_position") %>% select(-sex)
head(cM_Recom_femPOS)

#outfile = file.path("/Users/nuriteliash/Desktop", "cM_Recom_femPOS.pdf")
#lmv.linkage.plot(mapthis = cM_Recom_femPOS, outfile = outfile, main="Female positions, assuming recombination in both sexes",col.main = "red")

# density map: denmap=TRUE
outfile = file.path("/Users/nuriteliash/Desktop", "cM_Recom_femPOS_dens_11_01.pdf")
lmv.linkage.plot(mapthis = cM_Recom_femPOS, outfile = outfile, main="Female positions, based on 1/1 x 0/1 cross, assuming recombination in both sexes",col.main = "red", denmap=TRUE)

## Male positions, assuming recombination in both sexes
cM_Recom_malePOS <- sites_recom_map %>% filter(sex=="male_position") %>% select(-sex)
head(cM_Recom_malePOS)
  
#outfile = file.path("/Users/nuriteliash/Desktop", "cM_Recom_malePOS.pdf")
#lmv.linkage.plot(mapthis = cM_Recom_malePOS, outfile = outfile, main="Male positions, assuming recombination in both sexes",col.main = "blue")

# density map: denmap=TRUE
outfile = file.path("/Users/nuriteliash/Desktop", "cM_Recom_malePOS_dens_11_01.pdf")
lmv.linkage.plot(mapthis = cM_Recom_malePOS, outfile = outfile, main="Male positions, based on 1/1 x 0/1 cross, assuming recombination in both sexes",col.main = "blue", denmap=TRUE)
```

